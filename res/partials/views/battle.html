<div class="section battle_view" ng-controller=" bt.game.battle.ng.controller ">
    <h2>BATTLE VIEW !!!</h2>
    Controller: {{ controllerName }}
    <br/><br/>

    <!-- Battle stats -->
    <div class="toolbox">

        <!-- Player information -->
        <div class="group player">
            <div class="header">
                <div class="title">Player:</div>
                <div class="data">{{ bt.game.battle.model.battleField.activePlayer }}</div>

                <div style="clear: both"></div>
                <div>Turn: {{ bt.game.battle.model.battleField.turnNumber }}</div>
                <div>Action: {{ bt.game.battle.model.battleField.actionNumber }} / 2</div>
            </div>
        </div>

        <!-- Game timers -->
        <div class="group section timers">
            <div class="header">
                <div class="title">Timers:</div>
            </div>
            <div class="timer">Battle timer: {{ bt.game.battle.timers.battleTimeFormated }} </div>
            <div class="timer">Action timer: {{ bt.game.battle.timers.playTimeFormated }} </div>
            <div class="action_endturn" ng-click=" passTurn(); ">End turn</div>
        </div>

        <!-- Graveyards -->
        <div class="group section graveyards">
            <div ng-repeat=" (player, units) in bt.game.battle.model.battleField.graveyard.units ">

                <div class="graveyard">
                    <div class="title">{{ player }}'s graveyard</div>
                    <div style="clear: both;"></div>
                    <div ng-repeat=" unit in units ">

                        <div class="info_parent" style="position:relative; float: left; width: 44px; height: 44px;">

                            <div class="unit {{ unit.style }}"></div>

                            <div class="info info_left">
                                <div class="toolbox">
                                    <div class="group hover">

                                        <div class="header">
                                            <div class="title">{{ unit.name }} (<div class="element_small_{{ unit.element }}"></div>)</div>
                                            <div class="data">{{ unit.id }}</div>
                                        </div>
                                        <div class="stone">
                                            <div class="element earth">{{ unit.comp.Earth }}</div>
                                            <div class="element fire">{{ unit.comp.Fire }}</div>
                                            <div class="element ice">{{ unit.comp.Ice }}</div>
                                            <div class="element wind">{{ unit.comp.Wind }}</div>
                                        </div>

                                        <div class="subgroup">
                                            <div class="unit_stats">
                                                <div class="hp">HP: {{ unit.hp }}</div>
                                                <div class="power_small">
                                                    <div class="type">General:</div>
                                                    <div class="stat value">{{ unit.general.value }}</div>
                                                    <div class="stat attack">{{ unit.general.attack }}</div>
                                                    <div class="stat defend">{{ unit.general.defense }}</div>
                                                </div>
                                                <div class="power_small">
                                                    <div class="type">Magic:</div>
                                                    <div class="stat value">{{ unit.magic.value }}</div>
                                                    <div class="stat attack">{{ unit.magic.attack }}</div>
                                                    <div class="stat defend">{{ unit.magic.defense }}</div>
                                                </div>
                                                <div class="power_small">
                                                    <div class="type">Physical:</div>
                                                    <div class="stat value">{{ unit.physical.value }}</div>
                                                    <div class="stat attack">{{ unit.physical.attack }}</div>
                                                    <div class="stat defend">{{ unit.physical.defense }}</div>
                                                </div>
                                            </div>

                                            <div style="clear: both; float: left; margin-top: 6px;">Weapon: {{ unit.weapon._type }} (<div class="element_small_{{ unit.weapon._dStone.element }}"></div>)</div>
                                            <div class="stone_small">
                                                <div class="comment">Stats:</div>
                                                <div class="element earth">{{ unit.weapon._dStone.comp.Earth }}</div>
                                                <div class="element fire">{{ unit.weapon._dStone.comp.Fire }}</div>
                                                <div class="element ice">{{ unit.weapon._dStone.comp.Ice }}</div>
                                                <div class="element wind">{{ unit.weapon._dStone.comp.Wind }}</div>
                                            </div>
                                            <div class="stone_small">
                                                <div class="comment">Bonus:</div>
                                                <div class="element earth">{{ unit.weaponBonus.comp.Earth }}</div>
                                                <div class="element fire">{{ unit.weaponBonus.comp.Fire }}</div>
                                                <div class="element ice">{{ unit.weaponBonus.comp.Ice }}</div>
                                                <div class="element wind">{{ unit.weaponBonus.comp.Wind }}</div>
                                            </div>

                                        </div>

                                    </div>

                                </div>

                            </div>
                        </div>

                    </div>
                </div>

            </div>

        </div>


        <!-- Selected field information -->
        <div ng-if=" bt.game.battle.model.battleField.grid.selectedTile ">
            <div class="group selected">

                <!-- Selected field's units -->
                <div ng-repeat=" unit in bt.game.battle.model.battleField.grid.selectedTile.contents ">

                    <div class="header">
                        <div class="title">{{ unit.name }} (<div class="element_small_{{ unit.element }}"></div>)</div>
                        <div class="data">{{ unit.id }}</div>
                    </div>
                    <div class="stone">
                        <div class="element earth">{{ unit.comp.Earth }}</div>
                        <div class="element fire">{{ unit.comp.Fire }}</div>
                        <div class="element ice">{{ unit.comp.Ice }}</div>
                        <div class="element wind">{{ unit.comp.Wind }}</div>
                    </div>

                    <div class="subgroup">
                        <div class="unit_stats">
                            <div class="hp">HP: {{ unit.hp }}</div>
                            <div class="power_small">
                                <div class="type">General:</div>
                                <div class="stat value">{{ unit.general.value }}</div>
                                <div class="stat attack">{{ unit.general.attack }}</div>
                                <div class="stat defend">{{ unit.general.defense }}</div>
                            </div>
                            <div class="power_small">
                                <div class="type">Magic:</div>
                                <div class="stat value">{{ unit.magic.value }}</div>
                                <div class="stat attack">{{ unit.magic.attack }}</div>
                                <div class="stat defend">{{ unit.magic.defense }}</div>
                            </div>
                            <div class="power_small">
                                <div class="type">Physical:</div>
                                <div class="stat value">{{ unit.physical.value }}</div>
                                <div class="stat attack">{{ unit.physical.attack }}</div>
                                <div class="stat defend">{{ unit.physical.defense }}</div>
                            </div>
                        </div>

                        <div style="clear: both; float: left; margin-top: 6px;">Weapon: {{ unit.weapon._type }} (<div class="element_small_{{ unit.weapon._dStone.element }}"></div>)</div>
                        <div class="stone_small">
                            <div class="comment">Stats:</div>
                            <div class="element earth">{{ unit.weapon._dStone.comp.Earth }}</div>
                            <div class="element fire">{{ unit.weapon._dStone.comp.Fire }}</div>
                            <div class="element ice">{{ unit.weapon._dStone.comp.Ice }}</div>
                            <div class="element wind">{{ unit.weapon._dStone.comp.Wind }}</div>
                        </div>
                        <div class="stone_small">
                            <div class="comment">Bonus:</div>
                            <div class="element earth">{{ unit.weaponBonus.comp.Earth }}</div>
                            <div class="element fire">{{ unit.weaponBonus.comp.Fire }}</div>
                            <div class="element ice">{{ unit.weaponBonus.comp.Ice }}</div>
                            <div class="element wind">{{ unit.weaponBonus.comp.Wind }}</div>
                        </div>

                    </div>
                </div>

                <div class="subgroup">
                    <div style="clear: both; float: left; margin-top: 6px;">Selected tile:</div>

                    <div class="stone_small">
                        <div class="element earth">{{ bt.game.battle.model.battleField.grid.selectedTile.comp.Earth }}</div>
                        <div class="element fire">{{ bt.game.battle.model.battleField.grid.selectedTile.comp.Fire }}</div>
                        <div class="element ice">{{ bt.game.battle.model.battleField.grid.selectedTile.comp.Ice }}</div>
                        <div class="element wind">{{ bt.game.battle.model.battleField.grid.selectedTile.comp.Wind }}</div>
                    </div>
                </div>


            </div>
        </div>

        <div ng-if=" bt.debugging.game.battle.showBattleLog == false">
            <a class="link" ng-click=" bt.debugging.game.battle.showBattleLog = true; ">Show battle log</a>
        </div>
        <div ng-if=" bt.debugging.game.battle.showBattleLog == true">
            <a class="link" ng-click=" bt.debugging.game.battle.showBattleLog = false; ">Hide battle log</a>
        </div>
    </div>

    <!-- Battle log -->
    <div ng-if=" bt.debugging.game.battle.showBattleLog ">
        <div class="toolbox">
            <div class="group log">
                <div class="header">
                    <div class="title">Battle log:</div>
                </div>

                <div ng-repeat=" message in bt.game.battle.ui.log.messages ">
                    <div class="log_message log_message_{{ message.style }}">
                        {{ message.time }}: <b>{{ message.message }}</b>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <p>

        <!-- Battle field -->
        <div class="grid">
            <div class="notifications">
                <div ng-if=" bt.game.battle.model.battleField.gameOver ">
                    <div class="game_over">GAME OVER</div>
                </div>
                <div ng-if=" bt.game.battle.ui._newTurnNotification ">
                    <div class="end_turn">{{ bt.game.battle.model.battleField.activePlayer }}'s turn ...</div>
                </div>
            </div>

            <div class="grid_row" ng-repeat=" tileRow in bt.game.battle.model.battleField.grid.tilesByY ">
                <div class="tile info_parent" ng-repeat=" tile in tileRow " ng-click=" processAction(tile) ">
                    <div class="tile_style {{ tile.style }}">

                        <div ng-if=" tile.units['scient'].length ">
                            <div class="unit {{ tile.units['scient'][0].style }}">
                                <div ng-if=" tile.units['scient'][0]._damage.has ">
                                    <div class="damage damage_{{ tile.units['scient'][0]._damage.has }}">-{{ tile.units['scient'][0]._damage.amount }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="distance">
                            {{ tile.distance }}
                        </div>

                    </div>

                    <div class="info">
                        <div class="toolbox">

                            <div class="group hover">

                                <!-- Selected field's units -->
                                <div ng-repeat=" unit in tile.contents ">

                                    <div class="header">
                                        <div class="title">{{ unit.name }} (<div class="element_small_{{ unit.element }}"></div>)</div>
                                        <div class="data">{{ unit.id }}</div>
                                    </div>
                                    <div class="stone">
                                        <div class="element earth">{{ unit.comp.Earth }}</div>
                                        <div class="element fire">{{ unit.comp.Fire }}</div>
                                        <div class="element ice">{{ unit.comp.Ice }}</div>
                                        <div class="element wind">{{ unit.comp.Wind }}</div>
                                    </div>

                                    <div class="subgroup">
                                        <div class="unit_stats">
                                            <div class="hp">HP: {{ unit.hp }}</div>
                                            <div class="power_small">
                                                <div class="type">General:</div>
                                                <div class="stat value">{{ unit.general.value }}</div>
                                                <div class="stat attack">{{ unit.general.attack }}</div>
                                                <div class="stat defend">{{ unit.general.defense }}</div>
                                            </div>
                                            <div class="power_small">
                                                <div class="type">Magic:</div>
                                                <div class="stat value">{{ unit.magic.value }}</div>
                                                <div class="stat attack">{{ unit.magic.attack }}</div>
                                                <div class="stat defend">{{ unit.magic.defense }}</div>
                                            </div>
                                            <div class="power_small">
                                                <div class="type">Physical:</div>
                                                <div class="stat value">{{ unit.physical.value }}</div>
                                                <div class="stat attack">{{ unit.physical.attack }}</div>
                                                <div class="stat defend">{{ unit.physical.defense }}</div>
                                            </div>
                                        </div>

                                        <div style="clear: both; float: left; margin-top: 6px;">Weapon: {{ unit.weapon._type }} (<div class="element_small_{{ unit.weapon._dStone.element }}"></div>)</div>
                                        <div class="stone_small">
                                            <div class="comment">Stats:</div>
                                            <div class="element earth">{{ unit.weapon._dStone.comp.Earth }}</div>
                                            <div class="element fire">{{ unit.weapon._dStone.comp.Fire }}</div>
                                            <div class="element ice">{{ unit.weapon._dStone.comp.Ice }}</div>
                                            <div class="element wind">{{ unit.weapon._dStone.comp.Wind }}</div>
                                        </div>
                                        <div class="stone_small">
                                            <div class="comment">Bonus:</div>
                                            <div class="element earth">{{ unit.weaponBonus.comp.Earth }}</div>
                                            <div class="element fire">{{ unit.weaponBonus.comp.Fire }}</div>
                                            <div class="element ice">{{ unit.weaponBonus.comp.Ice }}</div>
                                            <div class="element wind">{{ unit.weaponBonus.comp.Wind }}</div>
                                        </div>

                                    </div>
                                </div>

                                <div class="subgroup">
                                    <div style="clear: both; float: left; margin-top: 6px;">Tile:</div>

                                    <div class="stone_small">
                                        <div class="element earth">{{ tile.comp.Earth }}</div>
                                        <div class="element fire">{{ tile.comp.Fire }}</div>
                                        <div class="element ice">{{ tile.comp.Ice }}</div>
                                        <div class="element wind">{{ tile.comp.Wind }}</div>
                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div style="clear: both;"></div>

    </p>
</div>